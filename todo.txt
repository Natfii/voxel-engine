[X] Implement load game functionality (src/main.cpp:268) - DONE
[X] Implement save/load system (src/main_menu.cpp:78) - DONE
[X] Implement dirty list for water blocks instead of full scan (src/main.cpp:743) - ALREADY IMPLEMENTED
[X] Update rendering to show water height based on level (src/world.cpp:1120) - ALREADY IMPLEMENTED
[X] Track water-containing chunks (src/world.cpp:1134) - ALREADY IMPLEMENTED
[X] Track water level changes and spawn particles (src/world.cpp:1284) - DONE
[X] Add Exit to Main Menu button on pause menu - DONE
[X] Auto-save when exiting to main menu - DONE
[X] Enable world streaming for infinite chunk generation - DONE
[X] Fix Exit to Main Menu bug (was closing game instead of returning to menu) - DONE
[X] Fix world streaming bounds check blocking infinite generation - DONE
[X] Improve cave generation with winding tunnels and surface entrances - DONE

================================================================================
TEST FAILURE DEBUG SESSION - 10 Claude Agents Deployed
================================================================================

ROOT CAUSES IDENTIFIED FOR FAILING TESTS:
  1 - ChunkCorrectness (Failed)
  2 - MemoryLeaks (Failed)
  4 - Stress (Failed)

## CRITICAL ISSUE #1: MockVulkanRenderer Memory Leak
   File: tests/test_utils.h:224-233
   Problem: mapMemory() calls malloc() but unmapMemory() is a no-op
   Impact: MemoryLeaks test detects this immediately with Address Sanitizer
   Fix: Add std::unordered_map<VkDeviceMemory, void*> to track allocations
        In unmapMemory(), find pointer and free() it

## CRITICAL ISSUE #2: Deadlock in breakBlock/placeBlock
   Files: src/world.cpp:821 + src/chunk.cpp:461
   Problem: breakBlock() holds unique_lock on m_chunkMapMutex
            Then calls generateMesh() which calls getBlockAt()
            getBlockAt() tries to acquire shared_lock on SAME mutex
            std::shared_mutex is NOT reentrant -> DEADLOCK
   Impact: Any test calling generateMesh() hangs forever
   Fix: Already partially fixed with callerHoldsLock parameter
        Verify all callers pass correct value

## HIGH ISSUE #3: Race Conditions in World Class
   Files: src/world.cpp:464, 501, 511, 522
   Problem: Iterating m_chunks vector without holding m_chunkMapMutex
            WorldStreaming thread can modify vector during iteration
   Impact: Iterator invalidation, segfaults, corruption
   Locations:
   - registerWaterBlocks() line 464
   - createBuffers() lines 501, 511
   - cleanup() line 522
   Fix: Acquire lock before ALL iterations

## HIGH ISSUE #4: WaterSimulation Multiple Bugs
   File: src/water_simulation.cpp
   Bugs:
   a) Lines 145,223,269: operator[] creates empty cells (memory leak)
   b) Lines 208-209: Static RNG shared between threads (race condition)
   c) Lines 355-368: updateWaterBodies doesn't mark cells dirty (water won't flow)
   d) Line 73 vs 491: Chunk size mismatch (32 vs 16)
   Fix: Use find() not operator[], add mutex for RNG, call markDirty(), fix constants

## HIGH ISSUE #5: TreeGenerator Thread Unsafe RNG
   File: include/tree_generator.h:78
   Problem: std::mt19937 m_rng member accessed from multiple threads
            No mutex protection
   Impact: Undefined behavior during concurrent world generation
   Fix: Add std::mutex m_rngMutex, lock before all dist(m_rng) calls

## MEDIUM ISSUE #6: Missing Block ID Bounds Checks (16 locations)
   Files: chunk.cpp:493, water_simulation.cpp:426,446, world.cpp:827,865,960,1060,1082,1107,1132,1146, block_system.cpp:810,835,873, inventory.cpp:220,322, targeting_system.cpp:176
   Problem: registry.get(id) called without validating id is in range
   Impact: Out-of-bounds access, crashes
   Fix: Add bounds check before ALL get() calls:
        if (id < 0 || id >= registry.count()) return;

## MEDIUM ISSUE #7: Test Infrastructure No Cleanup
   File: tests/test_utils.h
   Problem: init_test_environment() called once for ALL tests
            BiomeRegistry, BlockRegistry, static noise never reset
            Tests share global state, contaminate each other
   Fix: Add cleanup_test_environment() to reset singletons

## TEST-SPECIFIC ISSUES:
   - ChunkStateTransitions assumes terrain at Y=0 (flaky)
   - BlockAccessBounds doesn't test setBlock bounds
   - WorldChunkLookup doesn't verify chunk positions
   - Stress test missing assertions in Test 3 and 7

## FIX PRIORITY:
   [1] MockVulkanRenderer leak - blocks MemoryLeaks test
   [2] Deadlock bug - blocks 22+ tests
   [3] World race conditions - blocks Stress tests
   [4] WaterSimulation bugs
   [5] TreeGenerator thread safety
   [6] Bounds checks
   [7] Test infrastructure

## ADDITIONAL FINDINGS:
   - BiomeRegistry has inconsistent locking (reads locked, writes not)
   - BlockRegistry missing destructor for Vulkan atlas resources
   - Tests haven't actually been run yet (LastTest.log is empty)
   - Address Sanitizer enabled - will catch all these issues

## AGENT REPORTS:
   Agent 1: MemoryLeaks analysis - found mapMemory leak
   Agent 2: Stress analysis - found missing assertions
   Agent 3: Chunk implementation - found deadlock
   Agent 4: World class - found 6 race conditions
   Agent 5: test_utils - found 8 issues
   Agent 6: ChunkCorrectness - found flaky tests
   Agent 7: WaterSimulation - found 7 critical bugs
   Agent 8: TreeGenerator - found thread safety issues
   Agent 9: Registries - found cleanup and thread safety issues
   Agent 10: Test logs - confirmed tests not run yet

